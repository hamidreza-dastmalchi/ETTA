import os
from .utils import Datum, DatasetBase, listdir_nohidden

from .imagenet import read_classnames

# template = ["itap of a {}.",
#                         "a bad photo of the {}.",
#                         "a origami {}.",
#                         "a photo of the large {}.",
#                         "a {} in a video game.",
#                         "art of the {}.",
#                         "a photo of the small {}."]

template = [
    'a bad photo of a {}.',
    'a photo of many {}.',
    'a sculpture of a {}.',
    'a photo of the hard to see {}.',
    'a low resolution photo of the {}.',
    'a rendering of a {}.',
    'graffiti of a {}.',
    'a bad photo of the {}.',
    'a cropped photo of the {}.',
    'a tattoo of a {}.',
    'the embroidered {}.',
    'a photo of a hard to see {}.',
    'a bright photo of a {}.',
    'a photo of a clean {}.',
    'a photo of a dirty {}.',
    'a dark photo of the {}.',
    'a drawing of a {}.',
    'a photo of my {}.',
    'the plastic {}.',
    'a photo of the cool {}.',
    'a close-up photo of a {}.',
    'a black and white photo of the {}.',
    'a painting of the {}.',
    'a painting of a {}.',
    'a pixelated photo of the {}.',
    'a sculpture of the {}.',
    'a bright photo of the {}.',
    'a cropped photo of a {}.',
    'a plastic {}.',
    'a photo of the dirty {}.',
    'a jpeg corrupted photo of a {}.',
    'a blurry photo of the {}.',
    'a photo of the {}.',
    'a good photo of the {}.',
    'a rendering of the {}.',
    'a {} in a video game.',
    'a photo of one {}.',
    'a doodle of a {}.',
    'a close-up photo of the {}.',
    'a photo of a {}.',
    'the origami {}.',
    'the {} in a video game.',
    'a sketch of a {}.',
    'a doodle of the {}.',
    'a origami {}.',
    'a low resolution photo of a {}.',
    'the toy {}.',
    'a rendition of the {}.',
    'a photo of the clean {}.',
    'a photo of a large {}.',
    'a rendition of a {}.',
    'a photo of a nice {}.',
    'a photo of a weird {}.',
    'a blurry photo of a {}.',
    'a cartoon {}.',
    'art of a {}.',
    'a sketch of the {}.',
    'a embroidered {}.',
    'a pixelated photo of a {}.',
    'itap of the {}.',
    'a jpeg corrupted photo of the {}.',
    'a good photo of a {}.',
    'a plushie {}.',
    'a photo of the nice {}.',
    'a photo of the small {}.',
    'a photo of the weird {}.',
    'the cartoon {}.',
    'art of the {}.',
    'a drawing of the {}.',
    'a photo of the large {}.',
    'a black and white photo of a {}.',
    'the plushie {}.',
    'a dark photo of a {}.',
    'itap of a {}.',
    'graffiti of the {}.',
    'a toy {}.',
    'itap of my {}.',
    'a photo of a cool {}.',
    'a photo of a small {}.',
    'a tattoo of the {}.',
    'a cinematic shot of a {}.',
    'a photo of a vintage {}.',
    'a microscopic view of a {}.',
    'an aerial view of a {}.',
    'a futuristic rendering of a {}.',
    'a watercolor painting of a {}.',
    'a conceptual art piece of a {}.',
    'a 3D model of a {}.',
    'a comic-style illustration of a {}.',
    'a hyper-realistic image of a {}.',
    'a minimalist photo of a {}.',
    'a night vision photo of a {}.',
    'a thermal image of a {}.',
    'an infrared photo of a {}.',
    'a time-lapse photo of a {}.',
    'a polaroid of a {}.',
    'a retro-style illustration of a {}.',
    'a photo of an abstract {}.',
    'a macro shot of a {}.',
    'a photo of a {} in motion.',
    'a slow shutter photo of a {}.',
    'a stylized drawing of a {}.',
    'a blueprint of a {}.',
    'a fantasy artwork of a {}.',
    'a photo of a {} in the wild.',
    'a documentary-style photo of a {}.',
    'a high-speed photo of a {}.',
    'a satellite image of a {}.',
    'a drone shot of a {}.',
    'a renaissance painting of a {}.',
    'a baroque painting of a {}.',
    'a surreal image of a {}.',
    'a cyberpunk rendering of a {}.',
    'a steampunk version of a {}.',
    'a vintage postcard of a {}.',
    'a fashion photo of a {}.',
    'a still life of a {}.',
    'a photo of a {} during sunset.',
    'a winter photo of a {}.',
    'a summer photo of a {}.',
    'a spring photo of a {}.',
    'an autumn photo of a {}.',
    'a microscopic shot of a {}.',
    'a close-up shot of a {}.',
    'a distant view of a {}.',
    'a whimsical drawing of a {}.',
    'a low-light photo of a {}.',
    'a HDR photo of a {}.',
    'a neon sign of a {}.',
    'a stained glass representation of a {}.',
    'a photo of a {} in a museum.',
    'a cover photo featuring a {}.',
    'a magazine photo of a {}.',
    'a scientific illustration of a {}.',
    'a logo design featuring a {}.',
    'a pixel art of a {}.',
    'a chalk drawing of a {}.',
    'a charcoal sketch of a {}.',
    'a pastel drawing of a {}.',
    'a wood carving of a {}.',
    'a metal sculpture of a {}.',
    'a ceramic {}.',
    'a woven tapestry of a {}.',
    'a neon illustration of a {}.',
    'a 90s-style photo of a {}.',
    'a photo of a {} at night.',
    'a top-down view of a {}.',
    'a whimsical sculpture of a {}.',
    'a retro advertisement of a {}.',
    'a stop-motion animation of a {}.',
    'a vintage film still of a {}.',
    'a documentary photo of a {}.',
    'a monochrome sketch of a {}.',
    'a pop art style of a {}.',
    'a graffiti mural of a {}.',
    'a fine art painting of a {}.',
    'a contemporary art piece of a {}.',
    'a distorted photo of a {}.',
    'a holographic image of a {}.',
    'a dreamlike photo of a {}.',
    'a high-contrast image of a {}.',
    'a muted color photo of a {}.',
    'a vibrant photo of a {}.',
    'a panoramic photo of a {}.',
    'a tilt-shift photo of a {}.',
    'a fisheye lens photo of a {}.',
    'a photo of a {} underwater.',
    'a photo of a {} in the sky.',
    'a winter wonderland photo of a {}.',
    'a desert landscape with a {}.',
    'a botanical illustration of a {}.',
    'a clinical photo of a {}.',
    'a candid photo of a {}.',
    'a reflective photo of a {}.',
    'a double exposure photo of a {}.',
    'a shadow of a {}.',
    'a silhouette of a {}.',
    'a vintage illustration of a {}.',
    'a digital painting of a {}.',
    'a traditional painting of a {}.'
]
# template = ['a bad photo of a {}.',
#     'a photo of many {}.',
#     'a sculpture of a {}.',
#     'a photo of the hard to see {}.',
#     'a low resolution photo of the {}.',
#     'a rendering of a {}.',
#     'graffiti of a {}.',
#     'a bad photo of the {}.',
#     'a cropped photo of the {}.',
#     'a tattoo of a {}.',
#     'the embroidered {}.',
#     'a photo of a hard to see {}.',
#     'a bright photo of a {}.',
#     'a photo of a clean {}.',
#     'a photo of a dirty {}.',
#     'a dark photo of the {}.',
#     'a drawing of a {}.',
#     'a photo of my {}.',
#     'the plastic {}.',
#     'a photo of the cool {}.',
#     'a close-up photo of a {}.',
#     'a black and white photo of the {}.',
#     'a painting of the {}.',
#     'a painting of a {}.',
#     'a pixelated photo of the {}.',
#     'a sculpture of the {}.',
#     'a bright photo of the {}.',
#     'a cropped photo of a {}.',
#     'a plastic {}.',
#     'a photo of the dirty {}.',
#     'a jpeg corrupted photo of a {}.',
#     'a blurry photo of the {}.',
#     'a photo of the {}.',
#     'a good photo of the {}.',
#     'a rendering of the {}.',
#     'a {} in a video game.',
#     'a photo of one {}.',
#     'a doodle of a {}.',
#     'a close-up photo of the {}.',
#     'a photo of a {}.',
#     'the origami {}.',
#     'the {} in a video game.',
#     'a sketch of a {}.',
#     'a doodle of the {}.',
#     'a origami {}.',
#     'a low resolution photo of a {}.',
#     'the toy {}.',
#     'a rendition of the {}.',
#     'a photo of the clean {}.',
#     'a photo of a large {}.',
#     'a rendition of a {}.',
#     'a photo of a nice {}.',
#     'a photo of a weird {}.',
#     'a blurry photo of a {}.',
#     'a cartoon {}.',
#     'art of a {}.',
#     'a sketch of the {}.',
#     'a embroidered {}.',
#     'a pixelated photo of a {}.',
#     'itap of the {}.',
#     'a jpeg corrupted photo of the {}.',
#     'a good photo of a {}.',
#     'a plushie {}.',
#     'a photo of the nice {}.',
#     'a photo of the small {}.',
#     'a photo of the weird {}.',
#     'the cartoon {}.',
#     'art of the {}.',
#     'a drawing of the {}.',
#     'a photo of the large {}.',
#     'a black and white photo of a {}.',
#     'the plushie {}.',
#     'a dark photo of a {}.',
#     'itap of a {}.',
#     'graffiti of the {}.',
#     'a toy {}.',
#     'itap of my {}.',
#     'a photo of a cool {}.',
#     'a photo of a small {}.',
#     'a tattoo of the {}.']


class ImageNetV2(DatasetBase):
    """ImageNetV2.

    This dataset is used for testing only.
    """

    dataset_dir = "imagenetv2"

    def __init__(self, root):
        root = os.path.abspath(os.path.expanduser(root))
        self.dataset_dir = os.path.join(root, self.dataset_dir)
        image_dir = "imagenetv2-matched-frequency-format-val"
        self.image_dir = os.path.join(self.dataset_dir, image_dir)
        self.template = template
        text_file = os.path.join(self.dataset_dir, "classnames.txt")
        classnames = read_classnames(text_file)

        data = self.read_data(classnames)

        super().__init__(test=data) 

    def read_data(self, classnames):
        image_dir = self.image_dir
        folders = list(classnames.keys())
        items = []

        for label in range(1000):
            class_dir = os.path.join(image_dir, str(label))
            imnames = listdir_nohidden(class_dir)
            folder = folders[label]
            classname = classnames[folder]
            for imname in imnames:
                impath = os.path.join(class_dir, imname)
                item = Datum(impath=impath, label=label, classname=classname)
                items.append(item)

        return items