import os

from .utils import Datum, DatasetBase, read_json


#template = ['a photo of a {}, a type of pet.']
#template = ['a photo of a {}.']


# template = [
#     "a photo of a cute {}.",
#     "a close-up photo of a {}.",
#     "a photo of a {} lying down.",
#     "a photo of a {} sitting.",
#     "a photo of a {} standing.",
#     "a photo of a {} playing.",
#     "a photo of a {} running outdoors.",
#     "a photo of a {} in a grassy field.",
#     "a photo of a {} indoors.",
#     "a photo of a {} on a couch.",
#     "a photo of a {} in a park.",
#     "a photo of a {} next to a toy.",
#     "a photo of a {} sleeping.",
#     "a photo of a {} yawning.",
#     "a black and white photo of a {}.",
#     "a photo of a {} looking at the camera.",
#     "a photo of a {} with its tongue out.",
#     "a photo of a {} in the sunshine.",
#     "a photo of a {} under a tree.",
#     "a photo of a {} on a leash.",
#     "a photo of a {} wearing a collar.",
#     "a photo of a {} dressed in clothes.",
#     "a portrait of a {}.",
#     "a painting of a {}.",
#     "a photo of a fluffy {}.",
#     "a photo of a short-haired {}.",
#     "a photo of a {} with its owner.",
#     "a photo of a group of {}.",
#     "a photo of a {} looking out a window.",
#     "a photo of a {} on a bed.",
#     "a photo of a {} in the snow.",
#     "a photo of a {} in autumn leaves.",
#     "a photo of a {} at the beach.",
#     "a photo of a wet {} after a bath.",
#     "a photo of a {} with its paws in the air.",
#     "a photo of a {} under a blanket.",
#     "a photo of a {} next to a bowl of food.",
#     "a photo of a {} drinking water.",
#     "a photo of a {} in a car.",
#     "a photo of a {} sticking its head out of a car window.",
#     "a photo of a {} playing with another pet.",
#     "a photo of a {} at the vet.",
#     "a photo of a {} in a crate.",
#     "a photo of a {} with a toy in its mouth.",
#     "a photo of a {} climbing on furniture.",
#     "a photo of a {} in a backyard.",
#     "a photo of a {} during golden hour.",
#     "a photo of a {} next to flowers.",
#     "a close-up photo of a {}'s face.",
#     "a photo of a {}'s paw.",
#     "a photo of a {} wearing a hat.",
#     "a drawing of a {}.",
#     "a statue of a {}.",
#     "a photo of a {} on a sunny day.",
#     "a photo of a {} on a rainy day.",
#     "a photo of a {} with a colorful background.",
#     "a photo of a {} in motion.",
#     "a photo of a {} looking curious.",
#     "a candid photo of a {}.",
#     "a professional photo of a {}.",
#     "a blurry photo of a {} running.",
#     "a photo of a sleepy {}.",
#     "a photo of a {} surrounded by toys.",
#     "a photo of a {} in a playful pose.",
#     "a photo of a {} next to a tree."
# ]


template = ['a bad photo of a {}.',
    'a photo of many {}.',
    'a sculpture of a {}.',
    'a photo of the hard to see {}.',
    'a low resolution photo of the {}.',
    'a rendering of a {}.',
    'graffiti of a {}.',
    'a bad photo of the {}.',
    'a cropped photo of the {}.',
    'a tattoo of a {}.',
    'the embroidered {}.',
    'a photo of a hard to see {}.',
    'a bright photo of a {}.',
    'a photo of a clean {}.',
    'a photo of a dirty {}.',
    'a dark photo of the {}.',
    'a drawing of a {}.',
    'a photo of my {}.',
    'the plastic {}.',
    'a photo of the cool {}.',
    'a close-up photo of a {}.',
    'a black and white photo of the {}.',
    'a painting of the {}.',
    'a painting of a {}.',
    'a pixelated photo of the {}.',
    'a sculpture of the {}.',
    'a bright photo of the {}.',
    'a cropped photo of a {}.',
    'a plastic {}.',
    'a photo of the dirty {}.',
    'a jpeg corrupted photo of a {}.',
    'a blurry photo of the {}.',
    'a photo of the {}.',
    'a good photo of the {}.',
    'a rendering of the {}.',
    'a {} in a video game.',
    'a photo of one {}.',
    'a doodle of a {}.',
    'a close-up photo of the {}.',
    'a photo of a {}.',
    'the origami {}.',
    'the {} in a video game.',
    'a sketch of a {}.',
    'a doodle of the {}.',
    'a origami {}.',
    'a low resolution photo of a {}.',
    'the toy {}.',
    'a rendition of the {}.',
    'a photo of the clean {}.',
    'a photo of a large {}.',
    'a rendition of a {}.',
    'a photo of a nice {}.',
    'a photo of a weird {}.',
    'a blurry photo of a {}.',
    'a cartoon {}.',
    'art of a {}.',
    'a sketch of the {}.',
    'a embroidered {}.',
    'a pixelated photo of a {}.',
    'itap of the {}.',
    'a jpeg corrupted photo of the {}.',
    'a good photo of a {}.',
    'a plushie {}.',
    'a photo of the nice {}.',
    'a photo of the small {}.',
    'a photo of the weird {}.',
    'the cartoon {}.',
    'art of the {}.',
    'a drawing of the {}.',
    'a photo of the large {}.',
    'a black and white photo of a {}.',
    'the plushie {}.',
    'a dark photo of a {}.',
    'itap of a {}.',
    'graffiti of the {}.',
    'a toy {}.',
    'itap of my {}.',
    'a photo of a cool {}.',
    'a photo of a small {}.',
    'a tattoo of the {}.',
    'a cute photo of a {}.',
    'a playful {} in action.',
    'a close-up portrait of a {}.',
    'a photo of a {} relaxing at home.',
    'a {} playing outdoors.',
    'a beautiful {} looking at the camera.',
    'a {} cuddling with its owner.',
    'a {} lying on a cozy bed.',
    'a {} enjoying a sunny day.',
    'a sleepy {} curled up comfortably.',
    'a {} with a playful expression.',
    'a close-up of a {}â€™s face.',
    'a happy {} wagging its tail.',
    'a {} resting peacefully.',
    'a {} exploring its surroundings.',
    'a {} in a pet-friendly park.',
    'a well-groomed {} looking adorable.',
    'a {} sitting attentively.',
    'a mischievous {} caught in action.',
    'a joyful {} playing with toys.',
    'a gentle {} resting on a sofa.',
    'a {} enjoying a walk with its owner.',
    'a curious {} exploring the backyard.',
    'a {} peeking out from behind furniture.',
    'a loyal {} sitting by its owner side.',
    'a {} with a shiny coat, posing for the camera.',
    'a {} looking out of a window.',
    'a {} being playful with other animals.',
    'a {} snuggled up in a cozy blanket.',
    'a {} enjoying a treat.',
    'a {} sitting in a sunlit spot on the floor.',
    'a {} showing off a new collar or accessory.',
    'a photo of a {} on a leash during a walk.',
    'a {} at the veterinarian, looking calm.',
    'a {} resting on a rug or mat.',
    'a {} splashing in a pool or puddle.',
    'a portrait of a {} with a loving expression.',
    'a photo of a {} with its favorite toy.',
    'a {} sleeping with paws tucked under.',
    'a {} happily rolling on the grass.']


# template = [
#     'a bad photo of a {}.',
#     'a photo of many {}.',
#     'a sculpture of a {}.',
#     'a photo of the hard to see {}.',
#     'a low resolution photo of the {}.',
#     'a rendering of a {}.',
#     'graffiti of a {}.',
#     'a bad photo of the {}.',
#     'a cropped photo of the {}.',
#     'a tattoo of a {}.',
#     'the embroidered {}.',
#     'a photo of a hard to see {}.',
#     'a bright photo of a {}.',
#     'a photo of a clean {}.',
#     'a photo of a dirty {}.',
#     'a dark photo of the {}.',
#     'a drawing of a {}.',
#     'a photo of my {}.',
#     'the plastic {}.',
#     'a photo of the cool {}.',
#     'a close-up photo of a {}.',
#     'a black and white photo of the {}.',
#     'a painting of the {}.',
#     'a painting of a {}.',
#     'a pixelated photo of the {}.',
#     'a sculpture of the {}.',
#     'a bright photo of the {}.',
#     'a cropped photo of a {}.',
#     'a plastic {}.',
#     'a photo of the dirty {}.',
#     'a jpeg corrupted photo of a {}.',
#     'a blurry photo of the {}.',
#     'a photo of the {}.',
#     'a good photo of the {}.',
#     'a rendering of the {}.',
#     'a {} in a video game.',
#     'a photo of one {}.',
#     'a doodle of a {}.',
#     'a close-up photo of the {}.',
#     'a photo of a {}.',
#     'the origami {}.',
#     'the {} in a video game.',
#     'a sketch of a {}.',
#     'a doodle of the {}.',
#     'an origami {}.',
#     'a low resolution photo of a {}.',
#     'the toy {}.',
#     'a rendition of the {}.',
#     'a photo of the clean {}.',
#     'a photo of a large {}.',
#     'a rendition of a {}.',
#     'a photo of a nice {}.',
#     'a photo of a weird {}.',
#     'a blurry photo of a {}.',
#     'a cartoon {}.',
#     'art of a {}.',
#     'a sketch of the {}.',
#     'an embroidered {}.',
#     'a pixelated photo of a {}.',
#     'itap of the {}.',
#     'a jpeg corrupted photo of the {}.',
#     'a good photo of a {}.',
#     'a plushie {}.',
#     'a photo of the nice {}.',
#     'a photo of the small {}.',
#     'a photo of the weird {}.',
#     'the cartoon {}.',
#     'art of the {}.',
#     'a drawing of the {}.',
#     'a photo of the large {}.',
#     'a black and white photo of a {}.',
#     'the plushie {}.',
#     'a dark photo of a {}.',
#     'itap of a {}.',
#     'graffiti of the {}.',
#     'a toy {}.',
#     'itap of my {}.',
#     'a photo of a cool {}.',
#     'a photo of a small {}.',
#     'a tattoo of the {}.',
#     # New extended prompts
#     'a hologram of the {}.',
#     'a pencil sketch of a {}.',
#     'a 3D printed {}.',
#     'a mosaic of a {}.',
#     'a thermal image of the {}.',
#     'a sepia-toned photo of the {}.',
#     'a watercolor painting of a {}.',
#     'a charcoal drawing of the {}.',
#     'an infrared image of a {}.',
#     'a stained glass {}.',
#     'a ceramic model of the {}.',
#     'a photo of a futuristic {}.',
#     'a wireframe rendering of a {}.',
#     'a laser-etched {}.',
#     'a clay sculpture of the {}.',
#     'a silhouette of a {}.',
#     'an x-ray of the {}.',
#     'a schematic drawing of a {}.',
#     'a 16-bit video game sprite of a {}.',
#     'a steampunk version of the {}.',
#     'a cubist painting of a {}.',
#     'a glitch art version of the {}.',
#     'a blueprint of a {}.',
#     'a pixel art of the {}.',
#     'a neon sign of a {}.',
#     'a lenticular image of a {}.',
#     'a photo of a vaporwave {}.',
#     'a hyper-realistic drawing of the {}.',
#     'a minimalist design of a {}.',
#     'a vintage postcard of the {}.',
#     'a photo of a robotic {}.',
#     'an acrylic painting of a {}.',
#     'a retro advertisement featuring the {}.',
#     'an underwater photo of a {}.',
#     'a macro photograph of the {}.',
#     'a stylized 80s neon photo of the {}.',
#     'a post-apocalyptic {}.',
#     'a gothic rendering of the {}.',
#     'a cubist interpretation of a {}.',
#     'a 3D render of a holographic {}.',
#     'a glass-blown {}.',
#     'a photorealistic render of the {}.',
#     'an abstract interpretation of a {}.',
#     'a bokeh effect photo of a {}.',
#     'a foggy landscape with a {}.',
#     'an exploded-view diagram of a {}.',
#     'a vintage sepia photo of a {}.',
#     'a Renaissance-style painting of the {}.',
#     'a pixelated video game version of the {}.',
#     'an oil painting of the {}.',
#     'a futuristic concept art of a {}.',
#     'a graffiti stencil of a {}.'
# ]



class OxfordPets(DatasetBase):

    dataset_dir = 'oxford_pets'

    def __init__(self, root):
        self.dataset_dir = os.path.join(root, self.dataset_dir)
        self.image_dir = os.path.join(self.dataset_dir, 'images')
        self.anno_dir = os.path.join(self.dataset_dir, 'annotations')
        self.split_path = os.path.join(self.dataset_dir, 'split_zhou_OxfordPets.json')

        self.template = template

        test = self.read_split(self.split_path, self.image_dir)

        super().__init__(test=test)
    
    @staticmethod
    def read_split(filepath, path_prefix):
        def _convert(items):
            out = []
            for impath, label, classname in items:
                impath = os.path.join(path_prefix, impath)
                item = Datum(
                    impath=impath,
                    label=int(label),
                    classname=classname
                )
                out.append(item)
            return out
        
        print(f'Reading split from {filepath}')
        split = read_json(filepath)
        test = _convert(split['test'])

        return test